<% include ../partials/header %>

<div class="container">
	<div class="row">
		<div class="col-md-3">
			<p class="lead">
				Exercise
			</p>
			<div class="list-group">
				<li class="list-group-item active">
					Info 1
				</li>
				<li class="list-group-item">
					Info 2
				</li>
				<li class="list-group-item">
					Info 3
				</li>
			</div>
		</div>
		<div class="col-md-9">
			<div class="card">
				<img class="card-img-top" src="<%= exercise.image %>" alt="Card image cap">
				<div class="card-body">
					<h5 class="card-title"><%= exercise.name %></h5>
					<p class="card-text"><%= exercise.description %></p>
					<% if(currentUser && exercise.author.id.equals(currentUser._id)){ %>
						<a class="btn btn-warning btn-lg" href="/exercises/<%= exercise._id %>/edit">Edit</a>
						<form id="delete-form" action="/exercises/<%= exercise._id %>?_method=DELETE" method="POST">
							<button class="btn btn-danger btn-lg">Delete</button>
						</form>
					<% } %>
				</div>

				<div class="card-header">
					<a class="btn btn-success btn-lg" href="/exercises/<%= exercise._id %>/notes/new">Add New Note</a>
					<% if(currentUser){ %>
						<form action="/exercises/<%= exercise._id %>/profile" method="POST">
							<button class="btn btn-danger btn-xs">Save</button>
						</form>
					<% } %>
					<p>
						<% exercise.notes.forEach( function(note){ %>

							<%	if(note.author.username === (currentUser.username)){%>
								<p> <strong><%= note.author.username %></strong></p>
								<p> <%= note.text %> </p>
							<%	}%>
							<% if(currentUser && note.author.id.equals(currentUser._id)){ %>
								<a class="btn btn-xs btn-warning"
								   href="/exercises/<%= exercise._id %>/notes/<%= note._id %>/edit">
								   Edit
							   </a>
								<form id="comment-delete-form" action="/exercises/<%= exercise._id %>/notes/<%= note._id %>?_method=DELETE" method="POST">
									<button class="btn btn-danger btn-xs">Delete</button>
								</form>
							<% } %>
						<% }); %>
					</p>
				</div>
			</div>
		</div>
	</div>
</div>



<% include ../partials/footer %>
